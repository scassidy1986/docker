version: '3'
services:
  plex:
    container_name: plex
    image: lscr.io/linuxserver/plex:latest
    restart: unless-stopped
    environment:
      PUID: 1028
      PGID: 65536
      TZ: Europe/Dublin
      VERSION: docker
    network_mode: host
    volumes:
      - /volume1/docker/plex/Backup:/backup
      - /volume1/docker/plex:/config
      - /volume1/docker/plex:/transcode      
      - /volume1/media:/data
    healthcheck:
      test: curl --connect-timeout 15 --silent --show-error --fail http://localhost:32400/identity
      interval: 1m00s
      timeout: 15s
      retries: 3
      start_period: 1m00s

  sonarr:
    container_name: sonarr  
    image: lscr.io/linuxserver/sonarr:latest
    restart: unless-stopped
    environment:
      PUID: 1029
      PGID: 65536
      TZ: Europe/Dublin
    volumes:
      - /volume1/docker/sonarr:/config
      - /volume1/docker/sonarr/downloads:/downloads      
      - /volume1/media/tv:/tv
    ports:
      - 8989:8989
    healthcheck:
      test: curl --connect-timeout 15 --silent --show-error --fail http://localhost:8989
      interval: 1m00s
      timeout: 15s
      retries: 3
      start_period: 1m00s

  qbittorrent:
    container_name: qbittorrent
    image: linuxserver/qbittorrent:latest
    restart: unless-stopped
    environment:
      PUID: 1027
      PGID: 65536
      TZ: Europe/Dublin
      WEBUI_PORT: 8090
    volumes:
      - /volume1/docker/qbittorrent:/config
      - /volume1/data/torrents:/downloads
    ports:
      - 8090:8090
      - 6881:6881
      - 6881:6881/udp
    healthcheck:
      test: curl --connect-timeout 15 --silent --show-error --fail http://localhost:8090/api/v2/app/version
      interval: 30s
      timeout: 5s
      retries: 10
      start_period: 30s